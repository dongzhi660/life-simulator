<!DOCTYPE html>
<html>
<head>
    <title>äººç”Ÿæ¨¡æ‹Ÿå™¨</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .stats { background: #f0f0f0; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
        .event { background: #e0f7fa; padding: 8px; margin: 5px 0; border-radius: 3px; }
        button { margin: 5px; padding: 8px 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>äººç”Ÿæ¨¡æ‹Ÿå™¨</h1>
    <div id="game">
        <div id="stats" class="stats"></div>
        <div id="events"></div>
        <div id="choices"></div>
    </div>
    <script>
        const player = {
            name: "",
            age: 0,
            health: 100,
            happiness: 100,
            money: 0,
            alive: true,
            events: [],
            startYear: new Date().getFullYear() - Math.floor(Math.random() * 100),
        };

        function startGame() {
            player.name = prompt("ä½ çš„åå­—æ˜¯ï¼Ÿ", "å¼ ä¸‰");
            player.gender = prompt("ä½ çš„æ€§åˆ«æ˜¯ï¼Ÿ", "ç”·");
            logEvent(`${player.name} å‡ºç”Ÿäº†ï¼`);
            nextYear();
        }

        function nextYear() {
            if (!player.alive) return;
            
            player.age++;
            player.health += Math.floor(Math.random() * 6) - 2;
            player.happiness += Math.floor(Math.random() * 6) - 2;
            
            // é˜²æ­¢æ•°å€¼æº¢å‡º
            player.health = Math.max(0, Math.min(100, player.health));
            player.happiness = Math.max(0, Math.min(100, player.happiness));

            // éšæœºäº‹ä»¶
            if (Math.random() < 0.3) {
                const events = [
                    { msg: "ä½ æ„Ÿå†’äº†", health: -10, happiness: -5 },
                    { msg: "ä½ æ¡åˆ°é’±", money: 50 },
                    { msg: "ä½ äº¤åˆ°äº†æ–°æœ‹å‹", happiness: 15 },
                    { msg: "ä½ é­é‡è½¦ç¥¸", health: -30, happiness: -20 },
                ];
                const event = events[Math.floor(Math.random() * events.length)];
                player.money += event.money || 0;
                player.health += event.health || 0;
                player.happiness += event.happiness || 0;
                logEvent(event.msg);
            }

            // æ£€æŸ¥æ­»äº¡
            if (player.health <= 0 || (player.age > 80 && Math.random() > 0.8)) {
                player.alive = false;
                const causes = ["è€æ­»", "å¿ƒè„ç—…", "æ„å¤–äº‹æ•…", "ç»ç—‡"];
                logEvent(`ğŸ’€ ${player.name} å›  ${causes[Math.floor(Math.random() * causes.length)]} å»ä¸–ï¼Œäº«å¹´ ${player.age} å²`);
                saveLife();
                return;
            }

            updateUI();
            showChoices();
        }

        function logEvent(msg) {
            player.events.push(`${player.age} å²: ${msg}`);
            const eventsDiv = document.getElementById("events");
            eventsDiv.innerHTML += `<div class="event">${player.age} å²: ${msg}</div>`;
            eventsDiv.scrollTop = eventsDiv.scrollHeight;
        }

        function updateUI() {
            const statsDiv = document.getElementById("stats");
            statsDiv.innerHTML = `
                <h2>${player.name} (${player.age} å², ${player.startYear + player.age} å¹´)</h2>
                <p>â¤ï¸ å¥åº·: ${player.health}/100</p>
                <p>ğŸ˜Š å¿«ä¹: ${player.happiness}/100</p>
                <p>ğŸ’° é‡‘é’±: ${player.money}</p>
            `;
        }

        function showChoices() {
            const choicesDiv = document.getElementById("choices");
            choicesDiv.innerHTML = "";
            
            const choices = [
                { text: "å·¥ä½œ", money: 50, happiness: -10 },
                { text: "ä¼‘æ¯", health: 10, happiness: 5 },
                { text: "ç¤¾äº¤", happiness: 15, money: -10 },
                { text: "é”»ç‚¼", health: 15, happiness: -5 },
            ];

            choices.forEach(choice => {
                const button = document.createElement("button");
                button.textContent = choice.text;
                button.onclick = () => {
                    player.money += choice.money || 0;
                    player.health += choice.health || 0;
                    player.happiness += choice.happiness || 0;
                    logEvent(`ä½ é€‰æ‹©äº† ${choice.text}`);
                    nextYear();
                };
                choicesDiv.appendChild(button);
            });
        }

        function saveLife() {
            const data = JSON.stringify(player, null, 2);
            const blob = new Blob([data], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = `${player.name}_äººç”Ÿè®°å½•.json`;
            a.click();
        }

        startGame();
    </script>
</body>
</html>